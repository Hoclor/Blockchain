\documentclass[11pt,a4paper]{article}
\usepackage[margin=0.5in, bottom=1.75cm]{geometry}
\usepackage{caption}
\usepackage{tabu}
\usepackage[hidelinks]{hyperref}

\captionsetup[figure]{labelfont=bf}
\captionsetup[table]{labelfont=bf}

\title{\vspace{-2em}Blockchain and Cryptocurrencies Coursework}
\author{pbqk24}
%\date{}

\begin{document}
	\maketitle
	
	\vspace{-3em}
	
	\section{Mining Puzzles}
	
	\subsection{Proof of Work}
	The requested information for Proof of Work is as follows:
		
	\begin{table}[h!]
		\centering
		\begin{tabu} to 1.0\linewidth {|r|p{8cm}|X[l]|}
			\hline
			Index&Information&Value\\
			\hline
			1&User ID&pbqk24\\
			\hline
			2&Block hash target calculated (hex)&000003e7fc1800000000000000000000\newline00000000000000000000000000000000\\
			\hline
			3&Nonce value (int)&$2171906$\\
			\hline
			4&Number of (double) hashes performed&$2171907$ (one per nonce tried, starting at 0)\\
			\hline
			5&Estimate for mining time for difficulty $= 1$&$58629$ seconds\\
			 &Estimate for mining time for difficulty $= 7454968648263$&$4.37*10^{17}$ seconds\\
			\hline
		\end{tabu}
		\caption{Mining Puzzles: Information Requested}
		\label{table_mining_puzzles_pow}
	\end{table}

	\noindent The equations used for calculating the mining time estimates $t$ are as follows:
	
	\begin{equation}
	target = \frac{target_{initial}}{difficulty}
	\end{equation}
	
	\begin{equation}
	h_q = \frac{h_{space}}{target}
	\end{equation}
	
	\begin{equation}
	t = h_q * t_h
	\end{equation}
	
	Where $h_q$ is the estimated number of hashes required to be performed to find a valid hash, $target$ is the target value, $t_h$ is the estimated time per hash calculated by timing how long it takes to perform a large number of hashes (e.g. $10^9$) and finding the average. $t_h$ was computed as $1.365*10^{-5}$ and used for both calculations.
	
	For difficulty of $1$:
	
	$$target = \frac{00000000FFFF0000000000000000000000000000000000000000000000000000}{1}$$
	
	$$h_q = \frac{2^{256}}{00000000FFFF0000000000000000000000000000000000000000000000000000} = 4295032833$$
	
	$$t = 4295032833 * 1.365*10^{-5} = 58629$$
	
	For difficulty of $7454968648263$:
	
	$$target = \frac{00000000FFFF0000000000000000000000000000000000000000000000000000}{7454968648263} = 3.62*10^{54}$$
	
	$$h_q = \frac{2^{256}}{3.62*10^{54}} = 3.2 * 10^{22}$$
	
	$$t = 3.2 * 10^{22} * 1.365*10^{-5} = 4.37*10^{17}$$
	
	\subsection{Proof of Stake}
	
	The requested information for Proof of Stake is as follows:
	
	\begin{table}[h!]
		\centering
		\begin{tabu} to 1.0\linewidth {|r|p{7cm}|X[l]|}
			\hline
			Index&Information&Value\\
			\hline
			6&ECDSA public key (hex)&4f045a6cfacb3e67e7c5d4ddfb9f1acfe7d6ddda\newline c29869734cce5218cdab24e2d2cc72601138d6f\newline 324464df7691f819cd14e8b3752d9c463e5162a\newline ad37393ca0\\
			\hline
			7&Signature of "Hello world" (hex)&eae12ab8fdbeb5635ac45edbfceb999907a5b090\newline 42eeddbd9a07a744f656b3ac7e00124086256e5\newline caf86539e68186742d593e5e8b537b9f6d7ee055\newline 57c2ef68a\\
			\hline
			8&Signature used in calculating hit (hex)&aa2974089248c51977f63350c3aad2757b935d68\newline a236dd777621c3ed879657d2c5e1f01d22ad16b\newline b2d37f1c2567d1daeccd4e3f1a45201f53291e2e\newline ba9e9bea3\\
			\hline
			9&Hit value (hex)&a135a0781dd3c0f6\\
			\hline
			10&Time (s) that you could forge a new block&394\\
			\hline
		\end{tabu}
		\caption{Mining Puzzles Information}
		\label{table_mining_puzzles_pos}
	\end{table}
	
	\noindent The equations used for calculating the hit value are as follows:
	
	\begin{equation}
	hit_{full} = hash(sign(S_g))
	\end{equation}
	
	Where the hit value is the first 8 bytes of $hit_{full}$, and $S_g$ is the generation signature for the previous block:
	
	$$S_g = 9737957703d4eb54efdff91e15343266123c5f15aaf033292c9903015af817f1$$
	
	$$sign(S_g) = aa2974089248c51977f63350c3aad2757b935d68a236dd777621c3ed879657d2c5e1f01d22ad16bb2d37f1c2567d1daeccd4e3f1a45201f53291e2eba9e9bea3$$
	
	$$hash(sign(S_g))[:8] = a135a0781dd3c0f6$$
	
	\noindent The time in seconds when you would be able to forge a new block was calculated using the following equations:
	
	\begin{equation}
	T = T_b * B_e
	\end{equation}
	
	\begin{equation}
	t_{forge} = \frac{hit}{T}
	\end{equation}
	
	Where $T$ is the target value (independent of time passed), $T_b$ is the base target value, $B_e$ is your effective balance, and $t_{forge}$ is the time when you can forge a new block (rounded up, in seconds):
	
	$$T = 1229782938247303 * 24 = 29514790517935272$$
	
	$$t_{forge} = \frac{11616367251628998902}{29514790517935272} = 394$$
	
	\section{Interacting with bitcoin-testnet}
	
	The requested information for Task 2 is included in Table \ref{table_bitcoin_testnet} and \ref{table_bitcoin_testnet_transactions} below.
	
	\begin{table}[h!]
		\centering
		\begin{tabu} to 1.0\linewidth {|r|l|X[l]|}
			\hline
			Index&Information&Value\\
			\hline
			1&User ID&pbqk24\\
			\hline
			2&blockchain.com links&This is included in Table \ref{table_bitcoin_testnet_transactions} below\\
			\hline
			3&Transaction explanations&This is included in Table \ref{table_bitcoin_testnet_transactions} below\\
			\hline
			4&bitcoin-testnet address&mvcM9NV5hesnSUNpZGZ9Pyt3PK8xDFmCTp\\
			\hline
			5&100 Satoshi Tx ID&bfb4090faca08fe0f1ca46883cef1bf7e7860a4df6637acb7962741db0206f29\\
			&chain.so hyperlink&\href{https://chain.so/tx/BTCTEST/bfb4090faca08fe0f1ca46883cef1bf7e7860a4df6637acb7962741db0206f29}{https://chain.so/tx/BTCTEST/bfb4090faca08fe0f1ca46883cef1bf7e78\newline 60a4df6637acb7962741db0206f29}\\
			\hline
			6&Proof of Burn Tx ID&611186bc95e29fc70127fce35bd9c8a7f86c46f00aecd9df4765731d27f64d31\\
			&chain.so hyperlink&\href{https://chain.so/tx/BTCTEST/611186bc95e29fc70127fce35bd9c8a7f86c46f00aecd9df4765731d27f64d31}{https://chain.so/tx/BTCTEST/611186bc95e29fc70127fce35bd9c8a7f8\newline6c46f00aecd9df4765731d27f64d31}\\
			\hline
			7&Hex used as script&6a067062716b323\\
			&Explanation of hex script&This script is equivalent to `OP\_RETURN 06 7062716b323'. This causes the transaction to always be marked invalid, as OP\_RETURN always outputs \emph{fail}. The `06' signals that the next 6 bytes are to be pushed onto the stack, and `7062716b323' is the result of converting `pbqk24', my USER ID, from ASCII to hex.\\
			\hline
		\end{tabu}
		\caption{Bitcoin-Testnet Information}
		\label{table_bitcoin_testnet}
	\end{table}

	\begin{table}[h!]
		\centering
		\begin{tabu} to 1.0\linewidth {|r|l|X[l]|}
			\hline
			Tx&Aspect&Explanation\\
			\hline
			1&blockchain.com link&\href{https://www.blockchain.com/btc/tx/6c260da65fe98b08b27b80f8481c6f0ae34252921f6c34d327172472c5b419d7}{https://www.blockchain.com/btc/tx/6c260da65fe98b08b27b80f8481c6f0ae\newline 34252921f6c34d327172472c5b419d7}\\
			\hline
			&Input scripts&There is no input script since the coins are newly generated.\\
			\hline
			&Output scripts&There are three output scripts: one specifying the receiver of the mined bitcoin, one using OP\_RETURN to push data onto the blockchain (not decodable as text), and one that seems to have produced an error when decoding the script (but similarly to the second one, it transfers no coins).\\
			\hline
			&Inferences from structure&This is a transaction claiming the mining reward of (at the time) $\sim12.6$BTC (including transaction fees). This can be inferred as there is no input script, thus this transaction is the miner's claiming their reward.\\
			\hline
			2&blockchain.com link&\href{https://www.blockchain.com/btc/tx/4a3751b29128bea458f7f07d4f92b29322ba1900bbc364130bf2648e73f8cfad}{https://www.blockchain.com/btc/tx/4a3751b29128bea458f7f07d4f92b2932\newline 2ba1900bbc364130bf2648e73f8cfad}\\
			\hline
			&Input scripts&There is a single input script, which includes a witness.\\
			\hline
			&Output scripts&There are a large number of output scripts, most simply checking the hash of the receiver's address is valid, and a few additionally verifying and checking the signature.\\
			\hline
			&Inferences from structure&As this transaction has a single input, multiple outputs, and pays a large sum ($\sim1.7$ BTC), I suspect that this is payout from a mining guild, or possibly a sale of bitcoin by an exchange.\\
			\hline
			3&blockchain.com link&\href{https://www.blockchain.com/btc/tx/496cda9b0f4083b7775822f07a1541176866947b9f93006752de029489e1abd6}{https://www.blockchain.com/btc/tx/496cda9b0f4083b7775822f07a1541176\newline 866947b9f93006752de029489e1abd6}\\
			\hline
			 &Input scripts&This transaction contains a large number of input scripts. Most of these have a small input amount, with three being notably large: $\sim1, \sim4.3,$ and $\sim25$ bitcoin. All input scripts are from the same address.\\
			\hline
			 &Output scripts&The transaction contains two output scripts. One claims $\sim13.2$ BTC, and the other $22.5$ BTC.\\
			\hline
			 &Inferences from structure&Due to the amounts involved, and the exact payment of $22.5$ BTC to the second output address, I suspect that this transaction is a user selling BTC to an exchange. This is supported by investigating the recipient address of the $22.5$ BTC, which shows it being involved in numerous high-value transactions, where the address seems to mainly be used as a middle man, often transferring the exact input amount onwards to another address.\\
			\hline
		\end{tabu}
		\caption{Bitcoin-Testnet Transactions Details}
		\label{table_bitcoin_testnet_transactions}
	\end{table}
	
\end{document}